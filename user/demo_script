config ap_ssid DerKluge
config ap_password Bonn2016
config ntp_server 1.pool.ntp.org

on init
do
	subscribe local /test/#
	settimer 1 2000
	println "MQTT Script 1.0 starting"
	setvar $1 0
	setvar $2 0

config network 10.0.6.1

% Now the events, checked whenever something happens

% Here a remote republish, of any local topic starting with "/test/"

on topic local /test/#
do 
	publish remote $this_topic $this_data

% When timer 1 expires, publish a string 0 to the topic stored in $1
on timer 1
do 
	publish local /t/time $timestamp
	gpio_out 2 $1
	setvar $1 not $1
	setvar $2 $2 sub 1
	println $2
	settimer 1 2000

% Here a local publication once each day at noon
on clock 12:00:00
do
	publish local /t/2 "High Noon"

